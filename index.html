<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ù–∞—à 2024 –≥–æ–¥ –≤ —Å—Ç–æ—Ä–∏—Å ‚ù§Ô∏è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            touch-action: pan-y;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞ */
        .start-btn {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ff6b8b, #6a5af9);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 10px 30px rgba(255, 107, 139, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
            font-family: 'Caveat', cursive;
        }
        
        .start-btn:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç–æ—Ä–∏—Å */
        .story-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 999;
            color: white;
        }
        
        .story-container.active {
            display: flex;
            flex-direction: column;
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
        .story-progress {
            display: flex;
            gap: 4px;
            padding: 10px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }
        
        .progress-bar {
            flex: 1;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: white;
            transition: width 0.1s linear;
        }
        
        /* –®–∞–ø–∫–∞ */
        .story-header {
            display: flex;
            align-items: center;
            padding: 60px 15px 15px;
            position: relative;
            z-index: 10;
        }
        
        .story-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
        
        .story-username {
            font-weight: 600;
            font-size: 16px;
        }
        
        .story-timer {
            margin-left: auto;
            font-size: 14px;
            opacity: 0.8;
            background: rgba(0,0,0,0.5);
            padding: 4px 10px;
            border-radius: 20px;
        }
        
        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .story-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            text-align: center;
            overflow: hidden;
        }
        
        .story-slide {
            display: none;
            width: 100%;
            max-width: 600px;
            padding: 20px;
            animation: slideIn 0.5s ease-out;
        }
        
        .story-slide.active {
            display: block;
        }
        
        .story-emoji {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
            display: block;
        }
        
        .story-title {
            font-family: 'Caveat', cursive;
            font-size: 3.5rem;
            margin-bottom: 25px;
            line-height: 1.2;
        }
        
        .story-text {
            font-size: 1.8rem;
            line-height: 1.5;
            margin-bottom: 30px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 10px;
        }
        
        .story-stat-number {
            font-size: 6rem;
            font-weight: 900;
            line-height: 1;
            margin-bottom: 20px;
            display: block;
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .story-stat-label {
            font-size: 1.8rem;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .story-nav {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 50%;
            cursor: pointer;
            z-index: 5;
        }
        
        .story-nav.prev { left: 0; }
        .story-nav.next { right: 0; }
        
        /* –ö–æ–Ω—Ç—Ä–æ–ª—ã */
        .story-controls {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 1000;
        }
        
        .story-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .story-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .tap-hint {
            position: absolute;
            bottom: 100px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1rem;
            opacity: 0.7;
            animation: fadeInOut 2s infinite;
            padding: 0 20px;
        }
        
        .message-bubble {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 25px;
            margin: 20px auto;
            max-width: 500px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message-author {
            font-weight: 700;
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #ffcc00;
        }
        
        .message-text {
            font-size: 1.6rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .message-date {
            font-size: 1rem;
            opacity: 0.8;
            text-align: right;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) {
            .story-title { font-size: 2.8rem; }
            .story-text { font-size: 1.5rem; }
            .story-stat-number { font-size: 4.5rem; }
            .story-stat-label { font-size: 1.5rem; }
            .story-emoji { font-size: 4rem; }
            .message-text { font-size: 1.4rem; }
        }
        
        @media (max-width: 480px) {
            .story-title { font-size: 2.3rem; }
            .story-text { font-size: 1.3rem; }
            .story-stat-number { font-size: 3.5rem; }
            .story-stat-label { font-size: 1.3rem; }
            .story-emoji { font-size: 3.5rem; }
            .message-text { font-size: 1.2rem; }
            .start-btn { font-size: 1.3rem; padding: 15px 30px; }
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
        .gradient-text {
            background: linear-gradient(45deg, #ff6b8b, #ffa500, #ffcc00, #6a5af9);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 5s ease infinite;
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ -->
    <button class="start-btn" id="startStories">
        <i class="fab fa-instagram"></i>
        –ù–∞—à 2024 –≥–æ–¥ –≤ —Å—Ç–æ—Ä–∏—Å
    </button>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç–æ—Ä–∏—Å -->
    <div class="story-container" id="storyContainer">
        <div class="story-progress" id="storyProgress"></div>
        
        <div class="story-header">
            <div class="story-avatar">
                <i class="fas fa-heart"></i>
            </div>
            <div class="story-username" id="storyUsername">–ù–∞—à 2024 –≥–æ–¥</div>
            <div class="story-timer" id="storyTimer">10 —Å–µ–∫</div>
            <button class="story-btn close-btn" id="closeStory" style="position: absolute; right: 15px;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="story-content" id="storyContent">
            <!-- –°–ª–∞–π–¥—ã –¥–æ–±–∞–≤—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <div class="story-nav prev" id="prevStory"></div>
        <div class="story-nav next" id="nextStory"></div>
        
        <div class="tap-hint">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ ‚Ä¢ 10 —Å–µ–∫—É–Ω–¥ –¥–æ –∞–≤—Ç–æ—Å–º–µ–Ω—ã</div>
        
        <div class="story-controls">
            <button class="story-btn" id="pauseStory">
                <i class="fas fa-pause"></i>
            </button>
            <button class="story-btn" id="replayStory">
                <i class="fas fa-redo"></i>
            </button>
            <button class="story-btn" id="closeStories">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <script>
        // ========== –î–ê–ù–ù–´–ï –î–õ–Ø –°–¢–û–†–ò–° ==========
        const storiesData = {
            year: 2024,
            partnerName: "–ê–Ω—è",
            
            stories: [
                {
                    type: "intro",
                    emoji: "‚ù§Ô∏è",
                    title: "–ù–∞—à 2024 –≥–æ–¥",
                    text: "–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –º–∞–ª–µ–Ω—å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è –Ω–∞—à–µ–π –ª—é–±–≤–∏. –î–∞–≤–∞–π –≤—Å–ø–æ–º–Ω–∏–º —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã!",
                    duration: 8,
                    background: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                },
                {
                    type: "stat",
                    emoji: "üí¨",
                    title: "–¶–∏—Ñ—Ä–∞ –≥–æ–¥–∞",
                    value: "12,478",
                    label: "—Å–æ–æ–±—â–µ–Ω–∏–π –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥—É –∑–∞ —ç—Ç–æ—Ç –≥–æ–¥",
                    duration: 10,
                    background: "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
                },
                {
                    type: "stat",
                    emoji: "üìÖ",
                    title: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å",
                    value: "34",
                    label: "—Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å",
                    duration: 8,
                    background: "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"
                },
                {
                    type: "stat",
                    emoji: "üë´",
                    title: "–ë–∞–ª–∞–Ω—Å",
                    value: "50/50",
                    label: "–¢—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∞ 6,136 —Å–æ–æ–±—â–µ–Ω–∏–π, —è ‚Äî 6,342. –ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å!",
                    duration: 12,
                    background: "linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"
                },
                {
                    type: "stat",
                    emoji: "üî•",
                    title: "–†–µ–∫–æ—Ä–¥–Ω—ã–π –º–µ—Å—è—Ü",
                    value: "–ú–∞—Ä—Ç",
                    label: "–ò–º–µ–Ω–Ω–æ –≤ –º–∞—Ä—Ç–µ –º—ã –æ–±—â–∞–ª–∏—Å—å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ",
                    duration: 8,
                    background: "linear-gradient(135deg, #fa709a 0%, #fee140 100%)"
                },
                {
                    type: "moment",
                    emoji: "üçù",
                    title: "14 —Ñ–µ–≤—Ä–∞–ª—è",
                    text: "–ù–∞—à –ø–µ—Ä–≤—ã–π —É–∂–∏–Ω –≤–º–µ—Å—Ç–µ! –ü–æ–º–Ω–∏—à—å —Ç–≤–æ—é –ø–∞—Å—Ç—É? –û–Ω–∞ –±—ã–ª–∞ –Ω–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–ª–µ–Ω–∞, –Ω–æ —ç—Ç–æ –±—ã–ª —Å–∞–º—ã–π –≤–∫—É—Å–Ω—ã–π —É–∂–∏–Ω –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏ ‚ù§Ô∏è",
                    duration: 15,
                    background: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
                },
                {
                    type: "stat",
                    emoji: "üó£Ô∏è",
                    title: "–ù–∞—à–∏ –ª—é–±–∏–º—ã–µ —Å–ª–æ–≤–∞",
                    text: "¬´–õ—é–±–æ–≤—å¬ª ‚Äî 324 —Ä–∞–∑–∞<br>¬´–°–∫—É—á–∞—é¬ª ‚Äî 287 —Ä–∞–∑<br>¬´–ö–æ—Ç–∏–∫¬ª ‚Äî 256 —Ä–∞–∑<br>¬´–û–±–Ω–∏–º–∞—é¬ª ‚Äî 176 —Ä–∞–∑<br>¬´–ö—Ä–∞—Å–∏–≤–∞—è¬ª ‚Äî 132 —Ä–∞–∑–∞",
                    duration: 12,
                    background: "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"
                },
                {
                    type: "message",
                    emoji: "üíå",
                    title: "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–Ω—è",
                    author: "–ê–Ω—è",
                    date: "12 –º–∞—è, 23:42",
                    text: "–¢—ã –ª—É—á—à–µ–µ, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å —Å–æ –º–Ω–æ–π –≤ —ç—Ç–æ–º –≥–æ–¥—É. –ò–Ω–æ–≥–¥–∞ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞—é –Ω–∞—à–∏ –ø–µ—Ä–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —É–ª—ã–±–∞—é—Å—å –∫–∞–∫ –¥—É—Ä–æ—á–∫–∞ üòä",
                    duration: 15,
                    background: "linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"
                },
                {
                    type: "stat",
                    emoji: "üì∏",
                    title: "–ú–µ–¥–∏–∞",
                    value: "876 —Ñ–æ—Ç–æ",
                    label: "–∏ 245 –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –º—ã –æ–±–º–µ–Ω—è–ª–∏—Å—å",
                    duration: 10,
                    background: "linear-gradient(135deg, #a9c9ff 0%, #ffbbec 100%)"
                },
                {
                    type: "moment",
                    emoji: "üê±",
                    title: "3 –æ–∫—Ç—è–±—Ä—è",
                    text: "–î–µ–Ω—å, –∫–æ–≥–¥–∞ –º—ã —Ä–µ—à–∏–ª–∏ –∑–∞–≤–µ—Å—Ç–∏ –∫–æ—Ç–∏–∫–∞! –ü–æ–º–Ω–∏—à—å, –∫–∞–∫ –¥–æ–ª–≥–æ –≤—ã–±–∏—Ä–∞–ª–∏ –∏–º—è? –ù–∞—à–µ–º—É –ú—É—Ä–∑–∏–∫—É —É–∂–µ 2 –º–µ—Å—è—Ü–∞ ü•∞",
                    duration: 12,
                    background: "linear-gradient(135deg, #d299c2 0%, #fef9d7 100%)"
                },
                {
                    type: "message",
                    emoji: "‚ú®",
                    title: "–ï—â—ë –æ–¥–Ω–æ",
                    author: "–¢—ã",
                    date: "7 —Å–µ–Ω—Ç—è–±—Ä—è, 00:03",
                    text: "–¢–æ–ª—å–∫–æ —á—Ç–æ –æ—Å–æ–∑–Ω–∞–ª, —á—Ç–æ –¥—É–º–∞—é –æ —Ç–µ–±–µ –∫–∞–∂–¥—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –º–∏–Ω—É—Ç—É. –≠—Ç–æ –∏ –±–µ–∑—É–º–∏–µ, –∏ —Å–∞–º–æ–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.",
                    duration: 15,
                    background: "linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%)"
                },
                {
                    type: "stat",
                    emoji: "üòä",
                    title: "–≠–º–æ—Ü–∏–∏",
                    value: "1,543",
                    label: "—Å—Ç–∏–∫–µ—Ä–∞ —Å —É–ª—ã–±–∫–∞–º–∏ –∏ —Å–µ—Ä–¥–µ—á–∫–∞–º–∏ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏",
                    duration: 10,
                    background: "linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)"
                },
                {
                    type: "moment",
                    emoji: "üéÇ",
                    title: "12 –Ω–æ—è–±—Ä—è",
                    text: "–¢–≤–æ–π –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è! –Ø —Ç–∞–∫ –≤–æ–ª–Ω–æ–≤–∞–ª—Å—è, –≥–æ—Ç–æ–≤—è —Å—é—Ä–ø—Ä–∏–∑. –¢–≤–æ–∏ –≥–ª–∞–∑–∞, –∫–æ–≥–¥–∞ —Ç—ã —É–≤–∏–¥–µ–ª–∞ —Ç–æ—Ä—Ç ‚Äî —ç—Ç–æ –±–µ—Å—Ü–µ–Ω–Ω–æ. –°–ø–∞—Å–∏–±–æ –∑–∞ —ç—Ç—É —É–ª—ã–±–∫—É!",
                    duration: 15,
                    background: "linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%)"
                },
                {
                    type: "stat",
                    emoji: "‚è∞",
                    title: "–°–∞–º–∞—è –¥–æ–ª–≥–∞—è –±–µ—Å–µ–¥–∞",
                    value: "8 —á–∞—Å–æ–≤",
                    label: "42 –º–∏–Ω—É—Ç—ã ‚Äî —Å—Ç–æ–ª—å–∫–æ –¥–ª–∏–ª—Å—è –Ω–∞—à —Å–∞–º—ã–π –¥–æ–ª–≥–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä",
                    duration: 10,
                    background: "linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%)"
                },
                {
                    type: "outro",
                    emoji: "üåü",
                    title: "–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ!",
                    text: "–ó–∞ –∫–∞–∂–¥—ã–π —Å–º–µ—Ö, –∑–∞ –∫–∞–∂–¥–æ–µ ¬´–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ¬ª, –∑–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É —ç—Ç–æ–≥–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ –≥–æ–¥–∞. –Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º –≤—Å–µ —ç—Ç–∏ —Ü–∏—Ñ—Ä—ã –º–æ–≥—É—Ç –ø–æ–∫–∞–∑–∞—Ç—å. ‚ù§Ô∏è",
                    duration: 15,
                    background: "linear-gradient(135deg, #ff6b8b 0%, #6a5af9 100%)"
                }
            ]
        };

        // ========== –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let currentStoryIndex = 0;
        let totalStories = storiesData.stories.length;
        let storyInterval = null;
        let storyPaused = false;
        let progressIntervals = [];
        let storyDuration = 10000;

        // ========== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==========
        const startBtn = document.getElementById('startStories');
        const storyContainer = document.getElementById('storyContainer');
        const storyProgress = document.getElementById('storyProgress');
        const storyContent = document.getElementById('storyContent');
        const prevStoryBtn = document.getElementById('prevStory');
        const nextStoryBtn = document.getElementById('nextStory');
        const closeStoryBtn = document.getElementById('closeStory');
        const pauseStoryBtn = document.getElementById('pauseStory');
        const replayStoryBtn = document.getElementById('replayStory');
        const closeStoriesBtn = document.getElementById('closeStories');
        const storyTimer = document.getElementById('storyTimer');
        const storyUsername = document.getElementById('storyUsername');

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± Instagram Stories –∑–∞–≥—Ä—É–∂–µ–Ω—ã! –í—Å–µ–≥–æ —Å–ª–∞–π–¥–æ–≤:', storiesData.stories.length);
            storyUsername.textContent = `${storiesData.partnerName} ‚ù§Ô∏è`;
            createProgressBars();
            createStorySlides();
            setupEventListeners();
        });

        // ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function createProgressBars() {
            storyProgress.innerHTML = '';
            for (let i = 0; i < totalStories; i++) {
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressBar.innerHTML = `<div class="progress-fill" id="progress-${i}"></div>`;
                storyProgress.appendChild(progressBar);
            }
        }

        function createStorySlides() {
            storyContent.innerHTML = '';
            
            storiesData.stories.forEach((story, index) => {
                const slide = document.createElement('div');
                slide.className = 'story-slide';
                slide.id = `story-${index}`;
                
                let contentHTML = '';
                
                switch (story.type) {
                    case 'intro':
                    case 'outro':
                    case 'moment':
                        contentHTML = `
                            <div class="story-emoji gradient-text">${story.emoji}</div>
                            <h1 class="story-title gradient-text">${story.title}</h1>
                            <p class="story-text">${story.text}</p>
                        `;
                        break;
                        
                    case 'stat':
                        if (story.text) {
                            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞
                            contentHTML = `
                                <div class="story-emoji gradient-text">${story.emoji}</div>
                                <h1 class="story-title gradient-text">${story.title}</h1>
                                <p class="story-text">${story.text}</p>
                            `;
                        } else {
                            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –±–æ–ª—å—à–∏–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏
                            contentHTML = `
                                <div class="story-emoji gradient-text">${story.emoji}</div>
                                <h1 class="story-title gradient-text">${story.title}</h1>
                                <span class="story-stat-number gradient-text">${story.value}</span>
                                <p class="story-stat-label">${story.label}</p>
                            `;
                        }
                        break;
                        
                    case 'message':
                        contentHTML = `
                            <div class="story-emoji gradient-text">${story.emoji}</div>
                            <h1 class="story-title gradient-text">${story.title}</h1>
                            <div class="message-bubble">
                                <div class="message-author">${story.author}</div>
                                <div class="message-text">${story.text}</div>
                                <div class="message-date">${story.date}</div>
                            </div>
                        `;
                        break;
                }
                
                slide.innerHTML = contentHTML;
                storyContent.appendChild(slide);
            });
            
            console.log('‚úÖ –°–æ–∑–¥–∞–Ω–æ —Å–ª–∞–π–¥–æ–≤:', document.querySelectorAll('.story-slide').length);
        }

        function setupEventListeners() {
            startBtn.addEventListener('click', startStories);
            prevStoryBtn.addEventListener('click', () => navigateStory(-1));
            nextStoryBtn.addEventListener('click', () => navigateStory(1));
            closeStoryBtn.addEventListener('click', closeStories);
            closeStoriesBtn.addEventListener('click', closeStories);
            pauseStoryBtn.addEventListener('click', togglePause);
            replayStoryBtn.addEventListener('click', replayCurrentStory);
            
            // –ö–ª–∏–∫–∏ –ø–æ —ç–∫—Ä–∞–Ω—É –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            storyContent.addEventListener('click', (e) => {
                if (e.clientX < window.innerWidth / 2) {
                    navigateStory(-1); // –õ–µ–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - –Ω–∞–∑–∞–¥
                } else {
                    navigateStory(1); // –ü—Ä–∞–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - –≤–ø–µ—Ä–µ–¥
                }
            });
            
            // –ö–ª–∞–≤–∏—à–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            document.addEventListener('keydown', (e) => {
                if (!storyContainer.classList.contains('active')) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                    case 'a':
                        navigateStory(-1);
                        break;
                    case 'ArrowRight':
                    case 'd':
                    case ' ':
                        navigateStory(1);
                        break;
                    case 'Escape':
                        closeStories();
                        break;
                    case 'p':
                        togglePause();
                        break;
                    case 'r':
                        replayCurrentStory();
                        break;
                }
            });
            
            // –°–≤–∞–π–ø—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
            setupSwipeGestures();
            
            console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
        }

        function startStories() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ —Å—Ç–æ—Ä–∏—Å');
            startBtn.style.display = 'none';
            storyContainer.classList.add('active');
            document.body.style.overflow = 'hidden';
            showStory(0);
        }

        function showStory(index) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã
            if (index < 0) index = 0;
            if (index >= totalStories) {
                closeStories();
                return;
            }
            
            console.log(`üìä –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–æ—Ä–∏—Å ${index + 1}/${totalStories}`);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–ª–∞–π–¥—ã
            document.querySelectorAll('.story-slide').forEach(slide => {
                slide.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Å–ª–∞–π–¥
            const currentSlide = document.getElementById(`story-${index}`);
            if (currentSlide) {
                currentSlide.classList.add('active');
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω
            const currentStory = storiesData.stories[index];
            storyContainer.style.background = currentStory.background;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            currentStoryIndex = index;
            storyDuration = (currentStory.duration || 10) * 1000;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
            storyTimer.textContent = `${currentStory.duration || 10} —Å–µ–∫`;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            resetProgressBars();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞
            startProgressBar(index);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –∞–≤—Ç–æ—Å–º–µ–Ω—ã
            startStoryTimer();
        }

        function startProgressBar(index) {
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
            progressIntervals.forEach(interval => clearInterval(interval));
            progressIntervals = [];
            
            const progressFill = document.getElementById(`progress-${index}`);
            if (progressFill) {
                progressFill.classList.add('active');
                progressFill.style.width = '0%';
                
                const interval = setInterval(() => {
                    if (!storyPaused) {
                        const currentWidth = parseFloat(progressFill.style.width) || 0;
                        const increment = 100 / (storyDuration / 100);
                        
                        if (currentWidth < 100) {
                            progressFill.style.width = `${currentWidth + increment}%`;
                        }
                    }
                }, 100);
                
                progressIntervals.push(interval);
            }
        }

        function resetProgressBars() {
            document.querySelectorAll('.progress-fill').forEach(progress => {
                progress.style.width = '0%';
                progress.classList.remove('active');
            });
        }

        function startStoryTimer() {
            if (storyInterval) clearTimeout(storyInterval);
            
            storyInterval = setTimeout(() => {
                if (!storyPaused) {
                    navigateStory(1);
                }
            }, storyDuration);
        }

        function navigateStory(direction) {
            const newIndex = currentStoryIndex + direction;
            showStory(newIndex);
        }

        function togglePause() {
            storyPaused = !storyPaused;
            
            if (storyPaused) {
                pauseStoryBtn.innerHTML = '<i class="fas fa-play"></i>';
                if (storyInterval) {
                    clearTimeout(storyInterval);
                }
            } else {
                pauseStoryBtn.innerHTML = '<i class="fas fa-pause"></i>';
                startStoryTimer();
            }
        }

        function replayCurrentStory() {
            showStory(currentStoryIndex);
        }

        function closeStories() {
            storyContainer.classList.remove('active');
            startBtn.style.display = 'flex';
            document.body.style.overflow = 'auto';
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä—ã
            if (storyInterval) clearTimeout(storyInterval);
            progressIntervals.forEach(interval => clearInterval(interval));
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            currentStoryIndex = 0;
            storyPaused = false;
            
            console.log('‚èπÔ∏è –°—Ç–æ—Ä–∏—Å –∑–∞–≤–µ—Ä—à–µ–Ω—ã');
        }

        function setupSwipeGestures() {
            let startX = 0;
            let startY = 0;
            
            storyContainer.addEventListener('touchstart', (e) => {
                startX = e.changedTouches[0].screenX;
                startY = e.changedTouches[0].screenY;
            });
            
            storyContainer.addEventListener('touchend', (e) => {
                const endX = e.changedTouches[0].screenX;
                const endY = e.changedTouches[0].screenY;
                const diffX = endX - startX;
                const diffY = endY - startY;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –±—ã–ª –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø (–Ω–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π)
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                    if (diffX > 0) {
                        navigateStory(-1); // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –Ω–∞–∑–∞–¥
                    } else {
                        navigateStory(1); // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - –≤–ø–µ—Ä–µ–¥
                    }
                }
            });
        }

        // ========== –¢–ï–°–¢–û–í–´–ï –§–£–ù–ö–¶–ò–ò ==========
        window.testStories = function() {
            console.log('=== –¢–ï–°–¢ –°–¢–û–†–ò–° ===');
            console.log('–í—Å–µ–≥–æ —Å–ª–∞–π–¥–æ–≤:', totalStories);
            console.log('–¢–µ–∫—É—â–∏–π —Å–ª–∞–π–¥:', currentStoryIndex);
            console.log('–î–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞:', storiesData.stories[currentStoryIndex]);
            console.log('–≠–ª–µ–º–µ–Ω—Ç—ã DOM:');
            console.log('- –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞:', startBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            console.log('- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç–æ—Ä–∏—Å:', storyContainer ? '–Ω–∞–π–¥–µ–Ω' : '–Ω–µ –Ω–∞–π–¥–µ–Ω');
            console.log('- –°–ª–∞–π–¥—ã:', document.querySelectorAll('.story-slide').length);
        };

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
        // setTimeout(() => {
        //     startStories();
        // }, 1000);
    </script>
</body>
</html>